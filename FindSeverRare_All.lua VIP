-- FindSeverRare_All.lua
-- Gom c·∫£ FindSeverRare g·ªëc + FindSeverRare_Discord (l·ªçc Rare Box/Ultra Rare Box/Fruit)

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

--------------------------------------------------------------------
-- H√†m load script t·ª´ URL
--------------------------------------------------------------------
local function safeLoad(url)
    local ok, code = pcall(function()
        return game:HttpGet(url)
    end)
    if ok and code then
        local f, err = loadstring(code)
        if f then
            local ok2, err2 = pcall(f)
            if not ok2 then warn("[Loader] Error running "..url, err2) end
        else
            warn("[Loader] loadstring error for "..url, err)
        end
    else
        warn("[Loader] Cannot fetch "..url, code)
    end
end

--------------------------------------------------------------------
-- Script Webhook: ch·ªâ g·ª≠i khi ph√°t hi·ªán Rare Box, Ultra Rare Box, Fruit
--------------------------------------------------------------------
local WEBHOOK_URL = "https://discord.com/api/webhooks/1422372427886755861/yWe3oPd3AoAzW3EsllVkkncmz6fFTX4TDyRS0bGnJ_WnrkcAWavotHKfH0O-uwxgyA-R"

local function sendDiscordWebhook(title, description)
    local jobId = game.JobId or HttpService:GenerateGUID(false)
    local placeId = game.PlaceId or 0
    local link = "https://www.roblox.com/games/"..placeId.."/?gameInstanceId="..jobId

    local payload = {
        username = "RareFinder",
        embeds = {{
            title = title,
            description = (description or "") .. "\n\n**JobId:** `"..jobId.."`\n[Join Server]("..link..")",
            footer = { text = "Auto alert" },
            timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }

    local body = HttpService:JSONEncode(payload)

    if syn and syn.request then
        syn.request({Url = WEBHOOK_URL, Method = "POST", Headers = {["Content-Type"]="application/json"}, Body=body})
    elseif http_request then
        http_request({Url = WEBHOOK_URL, Method = "POST", Headers = {["Content-Type"]="application/json"}, Body=body})
    elseif request then
        request({Url = WEBHOOK_URL, Method = "POST", Headers = {["Content-Type"]="application/json"}, Body=body})
    else
        pcall(function()
            HttpService:PostAsync(WEBHOOK_URL, body, Enum.HttpContentType.ApplicationJson)
        end)
    end

    if setclipboard then pcall(function() setclipboard(jobId) end) end
end

local TARGETS = {
    ["Rare Box"] = true,
    ["Ultra Rare Box"] = true,
    ["Fruit"] = true
}

local function isTarget(name)
    return TARGETS[name] == true
end

-- Qu√©t trong workspace
spawn(function()
    while true do
        for _, obj in ipairs(workspace:GetDescendants()) do
            local ok, n = pcall(function() return obj.Name end)
            if ok and n and isTarget(n) then
                local desc = "Ph√°t hi·ªán: **"..n.."** t·∫°i v·ªã tr√≠: " .. (obj:GetFullName() or "unknown")
                sendDiscordWebhook("üéâ Rare Item Detected!", desc)
                wait(2)
            end
        end
        wait(1)
    end
end)

-- Hook script g·ªëc n·∫øu c√≥
if type(_G) == "table" then
    local old = _G.RareFound
    _G.RareFound = function(...)
        local args = {...}
        if args[1] and isTarget(tostring(args[1])) then
            sendDiscordWebhook("üéâ Rare Item Detected (Hook)", "Script g·ªëc ph√°t hi·ªán: "..tostring(args[1]))
        end
        if type(old) == "function" then return old(...) end
    end
end

print("[FindSeverRare_All.lua] Webhook integration loaded.")
sendDiscordWebhook("‚úÖ Script Loaded", "Webhook ƒë√£ k·∫øt n·ªëi th√†nh c√¥ng! Ng∆∞·ªùi ch∆°i: **"..localPlayer.Name.."**")

--------------------------------------------------------------------
-- Load script g·ªëc FindSeverRare.lua
--------------------------------------------------------------------
safeLoad("https://raw.githubusercontent.com/TommNger/MyHub.lua/main/FindSeverRare.lua")
